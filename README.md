# README

* Ruby version
- Ruby 2.4.1
- Rails 5.1.7

* System dependencies

* Configuration
- Clone repository from github
- Within the directory, run bundle install

* Database creation
- `rails db:create`
- `rails db:migrate`

* Database initialization
- `rake import_data:create_all`

* How to run the test suite
- `bundle exec rspec`

* Services (job queues, cache servers, search engines, etc.)

-----------------------------------------------------------------
# Using the API Endpoints

To boot up the application, run `rails s` from the project directory. By default, the domain for the application will be `localhost:3000`. Once you are running the API on your local machine, begin each URI with `/api/v1`; there is only one version of this application as of now. Following the version number, any of the 48 endpoint below can be used to query specific information from the database.

Where the path calls for an id number, such as `{merchant_id}`, type the id of the resource you are looking for. For endpoints where query parameters may be used, such as `find_all`, the searchable attributes will be listed in the readme. When using query parameters, append your search to the URI, e.g. `localhost:3000/api/v1/merchants/find_all?name=example`.

When using a date as a query parameter, it should be formatted as `27_Mar_2012_14:53:59_UTC_+00:00`.

Any calculation of revenue is define as the unit price of an item multiplied by the quantity purchased, both of which appear on the invoice_items table.

The `find` and `find_all` endpoints can also take multiple parameters separated by the `&` symbol, e.g. `find?name=example&merchant_id=2`

## MERCHANT ENDPOINTS

#### Record Endpoints
- `/merchants`
This endpoint will list an index of all merchants in the database.

- `/merchants/{merchant_id}`
This endpoint will list the information for the given merchant.

- `/merchants/find_all`
This endpoint will list the information for all merchants matching a given value for any merchant attributes. The searchable attributes for merchants are:
- name
- created_at
- updated_at

- `/merchants/find`
This endpoint will list the information for the first merchant in the database which matches a given value for any merchant attribute. The searchable attributes are the same as the find_all endpoint above.

- `/merchants/random`
This endpoint will list the information for one randomly selected merchant in the database.

#### Relationship Endpoints
- `/merchants/{merchant_id}/items`
This endpoint will list all items which are associated with the given merchant.

- `/merchants/{merchant_id}/invoices`
This endpoint will list all invoice which are associated with the given merchant.

#### Business Intelligence Endpoints
- `/merchants/most_revenue`
This endpoint will list a variable amount of merchants ordered by their total revenue generated. The amount of merchants shown is determined by a query parameter of quantity, e.g. `most_revenue?quantity=7`

- `/merchants/{merchant_id}/revenue`
This endpoint will show the revenue generated by the specified merchant on a given date. It takes a query parameter called date, e.g. `revenue?date=2012-03-26`

- `/merchants/{merchant_id}/favorite_customer`
This endpoint will show the specified merchant's favorite customer. This is defined as the customer who has completed the most successful transactions with that merchant.

## ITEM ENDPOINTS

#### Record Endpoints
- `/items`
This endpoint will list an index of all items in the database.

- `/items/{item_id}`
This endpoint will list the information for the given item.

- `/items/find_all`
This endpoint will list the information for all items matching a given value for any item attributes. The searchable attributes for items are:
- name
- description
- unit_price
- created_at
- updated_at
- merchant_id

- `/items/find`
This endpoint will list the information for the first item in the database which matches a given value for any item attribute. The searchable attributes are the same as the find_all endpoint about.

- `/items/random`
This endpoint will list the information for one randomly selected item in the database.


#### Relationship Endpoints
- `/items/{item_id}/merchant`
This endpoint will list the information for the merchant associated with the given item.

- `/items/{item_id/invoice_items}`
This endpoint will list the information for all invoice items associated will the given item.

#### Business Intelligence Endpoints
- `/items/{item_id}/best_day`
This endpoint will show the date on which the given item generated the most sales revenue.

- `/items/most_revenue`
This endpoint will show the information for a variable amount of items, ordered by their total sales revenue generated. The amount shown is determined by a query parameter of quantity, e.g. `most_revenue?quantity=7`

## CUSTOMER ENDPOINTS

#### Record Endpoints
- `/customers`
This endpoint will list an index of all customers in the database.

- `/customers/{customer_id}`
This endpoint will list the information for the given customer.

- `/customers/find_all`
This endpoint will list the information for all customers matching a given value for any customer attributes. The searchable attributes for customers are:
- first_name
- last_name
- created_at
- updated_at

- `/customers/find`
This endpoint will list the information for the first customer in the database which matches a given value for any customer attribute. The searchable attributes are the same as the find_all endpoint above.

- `/customers/random`
This endpoint will list the information for one randomly selected customer in the database.


#### Relationship Endpoints
- `/customers/{customer_id}/invoices`
This endpoint will list all invoices which are associated with the given customer.

- `/customers/{customer_id}/transactions`
This endpoint will list all transactions which are associated with the given customer.

#### Business Intelligence Endpoints
- `/customers/{customer_id}/favorite_merchant`
This endpoint will list the given customer's favorite merchant. This is defined as the merchant with which the customer has completed the most successful transactions.

## INVOICE ENDPOINTS

#### Record Endpoints
- `/invoices`
This endpoint will list an index of all invoices in the database.

- `/invoices/{invoice_id}`
This endpoint will list the information for the given invoice.

- `/invoices/find_all`
This endpoint will list the information for all invoices matching a given value for any invoice attribute. The searchable attributes for invoices are:
- status
- created_at
- updated_at
- customer_id
- merchant_id

- `/invoices/find`
This endpoint will all the user to search for the first invoice in the database which matches a given value for any invoice attribute. The searchable attributes are the same as the find_all endpoint above.

- `/invoices/random`
This endpoint will list the information for one randomly selected invoice in the database.

#### Relationship Endpoints
- `/invoices/{invoice_id}/transactions`
This endpoint will list all transactions associated with the given invoice.

- `/invoices/{invoice_id}/invoice_items`
This endpoint will list all invoice items associated with the given invoice.

- `/invoices/{invoice_id}/items`
This endpoint will list all items associated with the given invoice.

- `/invoices/{invoice_id}/customer`
This endpoint will list the information for the customer associated with the given invoice.

- `/invoices/{invoice_id}/merchant`
This endpoint will list the information for the merchant associated with the given invoice.

## INVOICE ITEM ENDPOINTS

#### Record Endpoints
- `/invoice_items`
This endpoint will list an index of all invoice items in the database.

- `/invoice_items/{invoice_item_id}`
This endpoint will list the information for the given invoice item.

- `/invoice_items/find_all`
This endpoint will list the information for all invoice items matching a given value for any invoice item attributes. The searchable attributes for invoice items are:
- quantity
- unit_price
- created_at
- updated_at
- invoice_id
- item_id

- `/invoice_items/find`
This endpoint will list the information for the first invoice item in the database which matches a given value for any invoice item attribute. The searchable attributes are the same as the find_all above.

- `/invoice_items/random`
This endpoint will list the information for one randomly selected invoice item in the database.

#### Relationship Endpoints
- `/invoice_items/{invoice_item_id}/invoice`
This endpoint will list the information for the invoice associated with the given invoice item.

- `/invoice_items/{invoice_item_id}/item`
This endpoint will list the information for the item associated with the given invoice item.

## TRANSACTION ENDPOINTS

#### Record Endpoints
- `/transactions`
This endpoint will list an index of all transactions in the database.

- `/transactions/{transaction_id}`
This endpoint will list the information for the given item.

- `/transactions/find_all`
This endpoint will list the information for all transactions matching a given value for any transaction attributes. The searchable attributes for transactions are:
- credit_card_number
- result
- created_at
- updated_at
- invoice_id

- `/transactions/find`
This endpoint will list the information for the first transaction in the database which matches a given value for any transaction attributes. The searchable attributes are the same as the find_all endpoint above.

- `/transactions/random`
This endpoint will list the information for one randomly selected transaction in the database.

#### Relationship Endpoints
- `/transactions/{transaction_id}/invoice`
This endpoint will list the information for the invoice associated with the given transaction.
